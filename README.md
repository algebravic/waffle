The Waffle game
===============

The Waffle game [Waffle](https://wafflegame.net/daily) is an
internet game.  Each challenge consists of 6 unknown 5 letter words
arranged in a 5 by 5 square, covering the top, bottom, left, right and
middle (there are 4 squares that are unoccupied).  Each occupied
square is filled with a letter, and with a color.  The answer is
obtained by some unknown permutation (which is a product of 10
transpositions) of the filled squares.  The color code gives clues:
green indicates that the letter is in a correct position.  Yellow
indicates that the row/column containing that square contains that
letter, but not in that position (more detail later).  Black indicates
that the row/column does not contain that letter, and not in that
position.  There's an extra condition if more than one square in a
row/column contains the same letter.  The rules are not completely
clear on this but I believe the following is true:

An *internal* square is one that is contained in exactly one
row/column.  If an internal square contains a yellow marked letter,
that indicates that that letter must appear somewhere else in that
row/column. By contrast, an external square only implies that it must
appear in the contained row or column.

Here are the details: For each row/column we make the following
calculation for each letter that appears there.  First mark all of the
green squares to have that letter placed there. Calculate the set of
remaining squares in the row/column for which the letter in question
is not colored yellow or black.  Let $b$ be the number of black
squares of that letter, $i$ the number of yellow internal squares, and
$e$ the number of yellow external squares. The black and yellow
squares are now restricted from containing that letter. Of the
remaining squares they must contain *at least* $i$ occurences of that
letter and no more than $i + e$ occurences.

There is also a *deluxe waffle* which is like the standard waffle
except that it uses a 7 by 7 square with 7 letter words, only using
the first, third, fifth and seventh rows and columns (thus leaving 9
empty squares), and using 8 unknown words.

I've found that the initial set of clues is sufficient to completely
solve the puzzle.  It works in two phases: The first phase uses a SAT
solver along with a dictionary of words to find all solutions given
only the initial set of clues.  In all cases, I've found that that's
sufficient to find a unique solution.  The second phase then uses
group theoretic calculations.  It first finds an initial permutation
of the squares that transforms the initial board into the solution.
It then computes a subgroup of the permutation group that would leave
the solution invariant, and then find an element in the coset
generated by the initial permutation and that subgroup which has the
maximal number of cycles.  Note that if $\sigma$ is a permutation in
$`S_n`$ with $t$ cycles (including the trivial ones), then it can be
written as a product of $n-t$ transpositions, and that figure is
minimal over all such products of transpositions.  In the 5 by 5 case,
the group that leaves the solution invariant is usually small enough
to exhaust over.  In the 7 by 7 case it isn't, so we use a discrete
hill climb with a tabu list.

Here are questions:

1) What vocabulary list is used?  I first used the list of answers for
*Wordle*, but that seemed to be lacking some words that were used in
*Waffle*. I then used the list of all [wordle test
words](https://github.com/tabatkins/wordle-list/blob/main/words),
which appeared to be sufficient. For 7 letter words I settled on the
list
[here](https://github.com/powerlanguage/word-lists/blob/master/word-list-7-letters.txt).

2) What method is used to generate an answer grid?  Ideally one would
like to generate each possible answer with equal probability. This
could be done with high accuracy with the Metropolis-Hastings
algorithm.  Probably it isn't done this way.

3) What method is used to generate the unknown permutation.  The
website says that it is the product of 10 transpositions for the 5 by
5 case and 20 for the 7 by 7 case.  Are they generated uniformly at
random, with or without replacement?
